最後に，実験で得られた鉱物種毎の位相速度分布を用いて行った波動伝播解析の結果を示す．
簡単のため位相速度のコントラストによって鉱物粒を表現した非均質等方性体
によって花崗岩を模擬し，2次元スカラー波の伝播散乱解析を行う．
位相速度の空間分布は、鉱物種をごとに区別して設定した場合と、
鉱物種による区別を行うことなく所定のガウス分布に従うものとして与えた
２種類の場合について行う．両者の結果を比較することにより，
鉱物種毎に位相速度を設定することの意義を示す．
\subsection{問題設定}
図\ref{fig:fig15}-(a)に示す矩形領域$D$における波動伝播問題を考える．
領域$D$における位相速度$c_p(\fat{x})$と密度$\rho(\fat{x})$は，
予め与えられているものとする．
ただし，鉱物種による密度の差は小さいことから，以下では
$\rho$は場所に依らず一定として扱う．
この領域の左側の境界($x=0$)に一様な応力$\sigma_{in}(t)$を加え，$x>0$の方向に伝播する
平面波を励起する．境界に加える応力の時間変化は図\ref{fig:fig15}-(b)に示す，
周波数1MHzのコサイン波をガウス関数で振幅変調した波形を用いる．
$y$方向には十分長い領域を想定し，$D$の上下の境界$y=0,H$は周期境界条件
を課す．一方，右側の境界$x=W$では応力はゼロであるとして，このとき
$D$内を各所で散乱を起こしながら伝播する平面波の挙動を調べる．
媒体は位相速度が場所によって異なるため，厳密な意味での平面波は存在し得ない．
しかしながら，以下で見るように
位相の揃った初動部分は概ね１次元的な$x>0$方向への進行波と見ることができるため，
ここでは便宜上平面波の励起や伝播という言い方をする。
\begin{figure}
\begin{center}
	\includegraphics[clip,scale=0.5]{Figs/model.eps}
	\caption{数値解析モデルと差分格子}
	\label{fig:fig15}
\end{center}
\end{figure}
\subsection{波動伝播問題の定式化と数値解析法}
スカラー波動場の支配方程式は，等方線形弾性体の運動方程式において
せん断剛性$\mu$をゼロとすることによって得られ，次のように表すことができる．
\begin{equation}
	\rho \dot{\fat{v}}=\nabla \sigma
	\label{eqn:eq_mot}
\end{equation}
\begin{equation}
	\dot{\sigma}=\lambda \nabla \cdot \fat{v}
	\label{eqn:Hooke}
\end{equation}
ここに，$\fat{v}$は速度ベクトルを，$\sigma$は応力テンソルの球成分を，
$\lambda$はラメ定数を表す．位相速度とラメ定数の関係は
$\lambda =\rho c_p^2$で与えられる．
媒体は時刻$t=0$において静止状態にあるものとし，初期条件を
\begin{equation}
	\sigma(\fat{x},0)=0, \ \ \fat{v}(\fat{x},0)=\fat{0}, \ \ (\fat{x} \in D)
	\label{eqn:IC}
\end{equation}
で与える．境界条件は上に述べて問題設定から
次のように書くことができる．
\begin{equation}
	\sigma(0,y,t)=\sigma_{in}(t), \ \ (t>0)
	\label{eqn:}
\end{equation}
\begin{equation}
	\sigma(W,y,t)=0, \ \ (t>0)
	\label{eqn:}
\end{equation}
\begin{equation}
	\sigma(x,0,t)=\sigma(x,H,t)  \ \ (x=W, t>0)
	\label{eqn:}
\end{equation}
以上で表される初期値-境界値問題を解くことで，領域$D$における平面波の伝播，散乱挙動を
調べることができる．数値解析には，有限差分法を用いる．
差分法解析を行うための格子配置を図\ref{fig:fig15}-(c)に示す．
この図は，差分格子の単位セルを示したもので，丸が速度ベクトル$\fat{v}$，
ひし形が応力$\sigma$の計算格子を表す．
非均質媒体を扱うためにはこれらの格子点に加え，密度$\rho$と位相速度$c_p$を与える
格子を決めておく必要がある．ここでは，位相速度は応力の計算格子と，
密度は速度の計算格子で与える．このようにすることで，位相速度の不連続部を
平均化すること無く取り扱うことができる．
密度に関しては一定と近似しているため，どの格子点に密度評価点を対応付けても違いはない．
式(\ref{eqn:eq_mot})と(\ref{eqn:Hooke})の空間微分は，図\ref{fig:fig15}-(c)の格子上で
中央差分で近似する．一方，時間の微分はリープフロッグ法を用いて離散化し，
速度$\fat{v}$と応力$\sigma$を交互に陽解法で求める．
\subsection{解析条件}
領域$D$のサイズを
\begin{equation}
	W=50[{\rm mm}], \ \  H=30[{\rm mm}]
	\label{eqn:dom_size}
\end{equation}
とし，時刻$ 0 <t < 15[\mu$sec]における解$\fat{v}$と$\sigma$を差分法によって求めた．
位相速度の空間分布は，実験で得た頻度分布(図\ref{fig:fig13})から鉱物種毎に
サンプリングし，鉱物粒内で一定の値を与えた．このようにして設定した位相速度の
空間分布の一例を図\ref{fig:fig16}-(a)に示す．
この図は領域$D$における位相速度$c_p(\fat{x})$の値を示したもので，
鉱物粒の分布は以下のようにして与えている．
はじめに，花崗岩供試体のスキャナ画像から，解析モデルに用いいる範囲を切り出し，
画像ピクセル毎に鉱物種を特定する．
次に，鉱物種ごとにピクセル間のユークリッド距離に基づいてクラスタリングを行い，
同一のクラスターに属するピクセルを一つの鉱物粒として扱う．
クラスタリングは鉱物種毎に行うことで，石英，ナトリウム長石，カリ長石の結晶粒
を定義することができる．なお，黒雲母の位相速度データは得られていないため，
黒雲母と判定させれたピクセルは最近傍のクラスターに振り分け，そのクラスターの
鉱物種で代替する．この方法ではクラスター数を調整することで，結晶粒の数を
任意に調整できる。その結果，平均的な結晶粒のサイズもコントロールできる。
さらに，クラスターの初期位置を乱数を使って設定することで，多数の
ランダム媒体を簡単に生成できる．ここでは，クラスターの数は，それぞれの鉱物種
で200個，合計600の鉱物粒が生成されている．その結果，結晶粒の粒径はおよそ1.6mm程度
となっている．なお，花崗岩供試体の画像上で特定した、鉱物種は黒雲母以外は事後的に
変更しないため，クラスタリングによって鉱物分布自体が変わることはない．
差分法解析を行う際の格子間隔$\Delta x, \Delta y$は，位相速度マップの
作成に用いた画像の1ピクセルに相当するサイズとした．
一方時間ステップ$\Delta t$は，位相速度の最大値$c_{max}$に対して，
安定条件を満足するように決定した．具体的には，これらのステップ長は
以下のようである．
\begin{equation}
	\Delta x = \Delta y= 0.055[{\rm mm}], \ \ \Delta t=0.04[\mu{\rm sec}]
	\label{eqn:}
\end{equation}
\subsection{解析結果}
\begin{figure}
\begin{center}
	\includegraphics[clip,scale=0.5]{Figs/field.eps}
	\caption{(a)数値解析モデルに設定した位相速度．(b),(c)速度場のスナップショット．}
	\label{fig:fig16}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
	\includegraphics[clip,scale=0.5]{Figs/decay.eps}
	\caption{振幅比の伝播距離による変化．}
	\label{fig:fig17}
\end{center}
\end{figure}
